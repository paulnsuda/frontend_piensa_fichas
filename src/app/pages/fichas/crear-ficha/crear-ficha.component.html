<div class="page-container">
  <div class="form-card">
    <button class="back-button" (click)="goBack()">← Volver al inicio</button>

    <h2>Crear Ficha Técnica</h2>

    <table class="tabla-ficha">
      <thead>
        <tr>
          <th>Ingrediente</th>
          <th>Unidad</th>
          <th>Precio</th>
          <th>Cantidad</th>
          <th>Costo</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let fila of filas; let i = index">
          <td>
            <select [(ngModel)]="fila.ingredienteId" name="ingrediente{{i}}" (change)="actualizarCosto(i)">
              <option [ngValue]="null">-- Selecciona --</option>
              <option *ngFor="let ing of ingredientesDisponibles" [ngValue]="ing.id">
                {{ ing.nombre }}
              </option>
            </select>
          </td>
          <td>{{ getIngrediente(fila.ingredienteId)?.unidad || '' }}</td>
          <td>{{ getIngrediente(fila.ingredienteId)?.precio || '' }}</td>
          <td>
            <input type="number" [(ngModel)]="fila.cantidad" (input)="actualizarCosto(i)" />
          </td>
          <td>{{ fila.costo.toFixed(2) }}</td>
          <td>
            <button (click)="eliminarFila(i)">Eliminar</button>
          </td>
        </tr>
      </tbody>
    </table>

    <button (click)="agregarFila()">+ Agregar Fila</button>

    <div class="total">
      <strong>Total: </strong> ${{ calcularTotal().toFixed(2) }}
    </div>
  </div>
</div>
