<div class="p-4 max-w-4xl mx-auto">
  <h2 class="text-2xl font-bold mb-4">âž• Registrar nueva compra</h2>

  <form [formGroup]="form" (ngSubmit)="guardar()" class="grid grid-cols-1 md:grid-cols-2 gap-4 bg-white p-4 rounded shadow">
    <div>
      <label class="block font-medium mb-1">DescripciÃ³n</label>
      <input formControlName="descripcion" class="w-full border p-2 rounded" />
    </div>

    <div>
      <label class="block font-medium mb-1">Proveedor</label>
      <select formControlName="proveedorId" class="w-full border p-2 rounded">
        <option value="">Seleccione un proveedor</option>
        <option *ngFor="let p of proveedores" [value]="p.id">{{ p.nombre }}</option>
      </select>
    </div>

    <div>
      <label class="block font-medium mb-1">Peso (kg)</label>
      <input type="number" formControlName="peso_kg" class="w-full border p-2 rounded" />
    </div>

    <div>
      <label class="block font-medium mb-1">Costo total</label>
      <input type="number" formControlName="costo_total" class="w-full border p-2 rounded" />
    </div>

    <div>
      <label class="block font-medium mb-1">Fecha de compra</label>
      <input type="date" formControlName="fecha_compra" class="w-full border p-2 rounded" />
    </div>

    <div class="md:col-span-2 flex justify-end">
      <button type="submit" [disabled]="cargando" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded">
        {{ cargando ? 'Guardando...' : 'Registrar compra' }}
      </button>
    </div>
  </form>

  <div *ngIf="mensaje" class="mt-4 p-3 text-green-700 bg-green-100 border border-green-300 rounded">
    {{ mensaje }}
  </div>

  <hr class="my-6" />

  <h3 class="text-xl font-semibold mb-3">ðŸ“¦ Historial de compras</h3>

  <div class="overflow-x-auto">
    <table class="min-w-full border border-gray-200 text-sm text-left bg-white rounded shadow">
      <thead class="bg-gray-100 text-gray-700">
        <tr>
          <th class="px-4 py-2">DescripciÃ³n</th>
          <th class="px-4 py-2">Proveedor</th>
          <th class="px-4 py-2">Peso (kg)</th>
          <th class="px-4 py-2">Costo ($)</th>
          <th class="px-4 py-2">Fecha</th>
          <th class="px-4 py-2 text-center">Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let compra of compras">
          <td class="border px-4 py-2">{{ compra.descripcion }}</td>
          <td class="border px-4 py-2">{{ compra.proveedor?.nombre || 'Desconocido' }}</td>
          <td class="border px-4 py-2">{{ compra.peso_kg }}</td>
          <td class="border px-4 py-2">${{ compra.costo_total }}</td>
          <td class="border px-4 py-2">{{ compra.fecha_compra }}</td>
          <td class="border px-4 py-2 text-center">
            <button
              (click)="eliminarCompra(compra.id)"
              class="bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs"
            >
              ðŸ—‘ Eliminar
            </button>
          </td>
        </tr>
        <tr *ngIf="compras.length === 0">
          <td colspan="6" class="text-center text-gray-500 py-4">No hay compras registradas.</td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
